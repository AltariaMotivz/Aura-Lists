<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Magical Wishlist</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@700&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>

    <!-- === NEW: The Authentication Gateway === -->
    <div id="auth-container">
        <div class="auth-box">
            <h1>Crystal Wishlist</h1>
            <p>Enter your phone number to begin</p>
            <form id="phone-form">
                <input type="tel" id="phone-number" placeholder="(201) 555-0123" required>
                <button type="submit" id="sign-in-button">Send Code</button>
            </form>
            <form id="code-form" class="hidden">
                 <input type="text" id="code-input" placeholder="123456" required>
                 <button type="submit" id="verify-code-button">Verify Code</button>
            </form>
            <div id="recaptcha-container"></div>
            <p id="auth-status" class="auth-status"></p>
        </div>
    </div>


    <!-- === This is your existing app, now hidden by default === -->
    <div id="app-container" class="hidden">
        <div class="page-container">
            <header>
                <h1>My Magical Wishlist</h1>
                <button id="sign-out-button" class="sign-out-btn">Sign Out</button>
            </header>

            <main class="wishlist-grid" id="wishlistGrid">
                <p id="loadingMessage" style="text-align: center; color: var(--text-muted);">Summoning your wishes...</p>
            </main>

            <button class="floating-add-btn" id="addWishBtn">+</button>
        </div>

        <!-- The "Add a Wish" Modal remains the same -->
        <div class="modal-backdrop" id="modalBackdrop">
            <div class="modal">
                <h2>Add a New Wish</h2>
                <form id="addWishForm">
                    <label for="itemName">Wish Title</label>
                    <input type="text" id="itemName" name="itemName" placeholder="e.g., A Book of Spells" required>
                    
                    <label for="itemLink">Link to Item</label>
                    <input type="url" id="itemLink" name="itemLink" placeholder="https://magical-emporium.com/...">

                    <label for="itemNotes">Notes</label>
                    <textarea id="itemNotes" name="itemNotes" rows="3" placeholder="Any details, colors, or enchantments..."></textarea>

                    <label for="itemImage">Image URL</label>
                    <input type="url" id="itemImage" name="itemImage" placeholder="https://magical-emporium.com/image.png">

                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelBtn">Cancel</button>
                        <button type="submit" class="btn-primary">Add Wish</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- === FIREBASE MAGIC (Now with Auth!) === -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        // NEW: We import the Authentication library
        import { getAuth } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        
        // Make both the database AND auth available to our script
        window.db = getFirestore(app);
        window.auth = getAuth(app);
    </script>

    <script src="script.js" defer></script>

</body>
</html>

